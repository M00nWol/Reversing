rule Gh0stRat_communications
{
    meta:
        Description = "Detects the Gh0stRat communication in Packet Captures"

    strings:
        $gst1 = {47 68 30 73 74 ?? ?? 00 00 ?? ?? 00 00 78 9c}
        $gst2 = {63 62 31 73 74 ?? ?? 00 00 ?? ?? 00 00 78 9c}
        $gst3 = {30 30 30 30 30 30 30 30 ?? ?? 00 00 ?? ?? 00 00 78 9c}
        $gst4 = {45 79 65 73 32 ?? ?? 00 00 ?? ?? 00 00 78 9c}
        $gst5 = {48 45 41 52 54 ?? ?? 00 00 ?? ?? 00 00 78 9c}
        $any_variant = /.{5,16}\x00\x00..\x00\x00\x78\x9c/

    condition:
        any of ($gst*) or ($any_variant)
}