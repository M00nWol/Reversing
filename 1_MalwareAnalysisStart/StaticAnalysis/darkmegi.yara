rule Darkmegi_Rootkit
{
    meta:
        Description = "Detects the kernel mode Driver and Dll component of Darkmegi/waltrodock rootkit"

    strings:
        $drv_str1 = "com32.dll"
        $drv_str2 = /H:\\RKTDOW~1\\RKTORI~1\\objfre\\i386\\RktDriver.pdb/
        $dll_str1 = "RktLibrary.dll"
        $dll_str2 = /\\\\.\\NpeDark/
        $dll_str3 = "RktDownload"
        $dll_str4 = "VersionKey.ini"

    condition:
    (all of them) or (any of ($drv_str*)) or (any of ($dll_str*))        
}